name: CI

on: 
  pull_request:
  push:
    branches: [master]

jobs:
  sim:
    runs-on: ubuntu-latest
    container: liuguo09/ubuntu-nuttx:18.04
    steps:
      - name: Run in container
        uses: actions/checkout@v1
      - name: Run cmds in container
        run: |
          uname -a
          pwd
          ls /prebuilt
          git clone https://github.com/apache/incubator-nuttx.git nuttx
          git clone https://github.com/apache/incubator-nuttx-apps.git apps
          cd nuttx
          ./tools/configure.sh sim:dsptest
          make -j4
  arm:
    runs-on: ubuntu-latest
    container: liuguo09/ubuntu-nuttx:18.04
    steps:
      - name: Run in container
        uses: actions/checkout@v1
      - name: Run cmds in container
        run: |
          uname -a
          pwd
          ls /prebuilt
          git clone https://github.com/apache/incubator-nuttx.git nuttx
          git clone https://github.com/apache/incubator-nuttx-apps.git apps
          cd nuttx
          ./tools/configure.sh photon:nsh
          make -j4
